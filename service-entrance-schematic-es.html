<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esquema de Entrada de Servicio - Ciudad a Casa</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0a0a0a;
            color: #e0e0e0;
            padding: 2rem;
        }

        .language-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
        }

        .language-toggle a {
            display: inline-block;
            background: #252525;
            color: #4ade80;
            padding: 0.5rem 1rem;
            text-decoration: none;
            border-radius: 6px;
            border: 1px solid #333;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .language-toggle a:hover {
            background: #333;
            border-color: #4ade80;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
        }

        h1 {
            color: #ffd700;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #888;
            font-size: 1.1rem;
        }

        .schematic-container {
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 12px;
            padding: 3rem;
            position: relative;
            min-height: 800px;
        }

        #schematic-svg {
            width: 100%;
            height: 700px;
        }

        .component {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .component:hover {
            filter: brightness(1.3);
        }

        .component.active {
            filter: brightness(1.5) drop-shadow(0 0 10px #ffd700);
        }

        .wire {
            stroke-width: 3;
            fill: none;
            transition: all 0.3s ease;
        }

        .wire.active {
            stroke-width: 5;
            filter: drop-shadow(0 0 8px currentColor);
        }

        .label {
            font-size: 14px;
            fill: #e0e0e0;
            pointer-events: none;
        }

        .label-bold {
            font-weight: 600;
            font-size: 16px;
        }

        .info-panel {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            background: #252525;
            border: 2px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
            width: 320px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .info-panel h3 {
            color: #ffd700;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #333;
            border: 1px solid #555;
            color: #e0e0e0;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: #444;
            border-color: #ffd700;
        }

        .close-btn.visible {
            display: flex;
        }

        .info-panel p {
            line-height: 1.6;
            margin-bottom: 0.8rem;
            color: #ccc;
        }

        .info-panel .spec {
            background: #1a1a1a;
            padding: 0.5rem;
            border-radius: 4px;
            margin: 0.5rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #4ade80;
        }

        .info-panel .warning {
            background: #2d1a1a;
            border-left: 3px solid #ff4444;
            padding: 0.8rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .info-panel .note {
            background: #1a2d2d;
            border-left: 3px solid #4ade80;
            padding: 0.8rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .legend {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #252525;
            border-radius: 8px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .legend-color {
            width: 40px;
            height: 4px;
            border-radius: 2px;
        }

        @media (max-width: 1200px) {
            .info-panel {
                position: static;
                transform: none;
                margin-top: 2rem;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="language-toggle">
        <a href="service-entrance-schematic.html">English</a>
    </div>

    <div class="container">
        <header>
            <h1>Entrada de Servicio Eléctrico</h1>
            <p class="subtitle">Del Poste de Servicio al Panel Principal - Servicio de 200A</p>
        </header>

        <div class="schematic-container">
            <svg id="schematic-svg" viewBox="0 0 1200 700" xmlns="http://www.w3.org/2000/svg">
                <!-- Utility Pole -->
                <g id="pole" class="component" data-info="pole">
                    <rect x="50" y="100" width="30" height="300" fill="#8B4513" stroke="#654321" stroke-width="2"/>
                    <circle cx="65" cy="120" r="25" fill="#444" stroke="#666" stroke-width="2"/>
                    <text x="65" y="50" class="label label-bold" text-anchor="middle">Poste de</text>
                    <text x="65" y="70" class="label label-bold" text-anchor="middle">Servicio</text>
                    <text x="65" y="85" class="label" text-anchor="middle">c/ Transformador</text>
                </g>

                <!-- Service Drop Wires -->
                <g id="service-drop">
                    <path id="wire-hot1" class="wire" d="M 80 120 Q 250 180, 400 140"
                          stroke="#000" stroke-dasharray="0"/>
                    <path id="wire-hot2" class="wire" d="M 80 130 Q 250 190, 400 150"
                          stroke="#ff0000" stroke-dasharray="0"/>
                    <path id="wire-neutral" class="wire" d="M 80 140 Q 250 200, 400 160"
                          stroke="#aaa" stroke-dasharray="0"/>
                    <text x="230" y="160" class="label" text-anchor="middle">Acometida Aérea</text>
                    <text x="230" y="180" class="label" text-anchor="middle" style="font-size: 12px;">(Cable Triplex)</text>
                </g>

                <!-- Weather Head -->
                <g id="weather-head" class="component" data-info="weatherhead">
                    <rect x="380" y="120" width="40" height="60" fill="#555" stroke="#777" stroke-width="2" rx="5"/>
                    <path d="M 400 120 Q 400 100, 420 100" stroke="#777" stroke-width="3" fill="none"/>
                    <text x="400" y="105" class="label" text-anchor="middle">Cabeza</text>
                    <text x="400" y="215" class="label" text-anchor="middle">Mural</text>
                </g>

                <!-- Conduit -->
                <g id="conduit">
                    <rect x="395" y="180" width="10" height="200" fill="#888" stroke="#666" stroke-width="1"/>
                    <text x="440" y="280" class="label">Tubo</text>
                    <text x="440" y="295" class="label">Conduit</text>
                </g>

                <!-- Meter Socket -->
                <g id="meter" class="component" data-info="meter">
                    <rect x="360" y="390" width="80" height="100" fill="#666" stroke="#888" stroke-width="2" rx="8"/>
                    <circle cx="400" cy="440" r="30" fill="#f0f0f0" stroke="#333" stroke-width="2"/>
                    <text x="400" y="445" class="label" text-anchor="middle" fill="#000" style="font-size: 12px;">kWh</text>
                    <text x="400" y="520" class="label label-bold" text-anchor="middle">Medidor</text>
                    <text x="400" y="540" class="label" text-anchor="middle" style="font-size: 12px;">(Propiedad de CFE)</text>
                </g>

                <!-- Wires from meter to panel -->
                <g id="meter-to-panel">
                    <line x1="400" y1="490" x2="400" y2="550" class="wire" stroke="#000" id="wire-meter-hot1"/>
                    <line x1="410" y1="490" x2="410" y2="550" class="wire" stroke="#ff0000" id="wire-meter-hot2"/>
                    <line x1="390" y1="490" x2="390" y2="550" class="wire" stroke="#aaa" id="wire-meter-neutral"/>
                </g>

                <!-- Main Service Panel -->
                <g id="main-panel" class="component" data-info="panel">
                    <rect x="320" y="550" width="160" height="120" fill="#555" stroke="#888" stroke-width="3" rx="8"/>
                    <rect x="335" y="565" width="130" height="30" fill="#333" stroke="#666" stroke-width="2" rx="4"/>
                    <text x="400" y="585" class="label" text-anchor="middle" style="font-size: 13px; font-weight: 600;">PRINCIPAL 200A</text>
                    <rect x="335" y="605" width="60" height="15" fill="#222" stroke="#666" stroke-width="1" rx="2"/>
                    <rect x="405" y="605" width="60" height="15" fill="#222" stroke="#666" stroke-width="1" rx="2"/>
                    <rect x="335" y="625" width="60" height="15" fill="#222" stroke="#666" stroke-width="1" rx="2"/>
                    <rect x="405" y="625" width="60" height="15" fill="#222" stroke="#666" stroke-width="1" rx="2"/>
                    <rect x="335" y="645" width="60" height="15" fill="#222" stroke="#666" stroke-width="1" rx="2"/>
                    <rect x="405" y="645" width="60" height="15" fill="#222" stroke="#666" stroke-width="1" rx="2"/>
                    <text x="400" y="695" class="label label-bold" text-anchor="middle">Panel Principal</text>
                    <text x="400" y="710" class="label" text-anchor="middle" style="font-size: 11px;">Square D Q22200NRB</text>
                </g>

                <!-- Ground wire and rod -->
                <g id="grounding" class="component" data-info="ground">
                    <line x1="480" y1="610" x2="550" y2="610" class="wire" stroke="#4ade80" stroke-width="3"/>
                    <line x1="550" y1="610" x2="550" y2="680" class="wire" stroke="#4ade80" stroke-width="3"/>
                    <line x1="545" y1="680" x2="555" y2="680" stroke="#4ade80" stroke-width="4"/>
                    <line x1="547" y1="685" x2="553" y2="685" stroke="#4ade80" stroke-width="3"/>
                    <line x1="549" y1="690" x2="551" y2="690" stroke="#4ade80" stroke-width="2"/>
                    <text x="580" y="650" class="label">Varilla de</text>
                    <text x="580" y="665" class="label">Tierra</text>
                </g>

                <!-- House -->
                <g id="house">
                    <path d="M 700 400 L 850 400 L 850 650 L 700 650 Z" fill="#2a2a2a" stroke="#444" stroke-width="2"/>
                    <path d="M 680 400 L 775 320 L 870 400 Z" fill="#1a1a1a" stroke="#444" stroke-width="2"/>
                    <rect x="730" y="570" width="40" height="60" fill="#555" stroke="#666" stroke-width="1"/>
                    <rect x="790" y="570" width="40" height="60" fill="#555" stroke="#666" stroke-width="1"/>
                    <text x="775" y="690" class="label label-bold" text-anchor="middle">Casa</text>
                    <text x="775" y="708" class="label" text-anchor="middle" style="font-size: 11px;">Un Piso</text>
                </g>

                <!-- Arrow showing flow -->
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#ffd700" />
                    </marker>
                </defs>
                <path d="M 120 450 L 320 450" stroke="#ffd700" stroke-width="2" fill="none"
                      marker-end="url(#arrowhead)" stroke-dasharray="5,5">
                    <animate attributeName="stroke-dashoffset" from="0" to="10" dur="1s" repeatCount="indefinite"/>
                </path>
                <text x="220" y="440" class="label" text-anchor="middle" fill="#ffd700">Flujo de Energía</text>

                <!-- Voltage labels -->
                <text x="900" y="450" class="label" style="font-size: 13px;">
                    <tspan x="900" dy="0">Voltaje:</tspan>
                    <tspan x="900" dy="20">• Fase 1 a Neutro: 120V</tspan>
                    <tspan x="900" dy="20">• Fase 2 a Neutro: 120V</tspan>
                    <tspan x="900" dy="20">• Fase 1 a Fase 2: 240V</tspan>
                </text>
            </svg>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #000;"></div>
                <span>Fase 1 (Negro) - 120V</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ff0000;"></div>
                <span>Fase 2 (Rojo) - 120V</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #aaa;"></div>
                <span>Neutro (Blanco/Gris)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #4ade80;"></div>
                <span>Tierra (Verde/Desnudo)</span>
            </div>
        </div>

        <div class="info-panel" id="info-panel">
            <button class="close-btn" id="close-btn" title="Reiniciar">×</button>
            <h3>Haz clic en cualquier componente para aprender más</h3>
            <p>Este esquema muestra el servicio eléctrico completo desde la compañía de servicios hasta tu panel principal.</p>
            <div class="note">
                <strong>Interactivo:</strong> Haz clic en diferentes partes del sistema para ver especificaciones detalladas y explicaciones.
            </div>
        </div>
    </div>

    <script>
        const defaultContent = `
            <h3>Haz clic en cualquier componente para aprender más</h3>
            <p>Este esquema muestra el servicio eléctrico completo desde la compañía de servicios hasta tu panel principal.</p>
            <div class="note">
                <strong>Interactivo:</strong> Haz clic en diferentes partes del sistema para ver especificaciones detalladas y explicaciones.
            </div>
        `;

        const infoContent = {
            pole: {
                title: "Poste de Servicio y Transformador",
                content: `
                    <p>La infraestructura de la compañía de servicios que reduce el alto voltaje de transmisión a voltaje residencial utilizable.</p>
                    <div class="spec">
                        Transformador: 7200V → 240V/120V<br>
                        Configuración: Bifásica
                    </div>
                    <p><strong>Cómo funciona:</strong> El transformador en el poste convierte la energía de alto voltaje de la red (típicamente 7,200V) a 240V/120V del sistema bifásico usado en hogares.</p>
                    <p>La compañía de servicios es propietaria y mantiene todo hasta e incluyendo el medidor.</p>
                `
            },
            weatherhead: {
                title: "Cabeza Mural (Entrada de Servicio)",
                content: `
                    <p>El punto donde los cables de servicio aéreos entran al sistema de tubería del edificio. El diseño curvado evita que el agua entre en la tubería.</p>
                    <div class="spec">
                        Tipo: Tapa de entrada resistente al clima<br>
                        Entrada de cable: Hacia abajo<br>
                        Protección: Lluvia, nieve, escombros
                    </div>
                    <div class="note">
                        <strong>Requisito de código:</strong> Debe instalarse con los cables entrando desde abajo para evitar infiltración de agua. La cabeza mural debe ser el punto más alto del mástil de servicio.
                    </div>
                    <p>Tres cables entran: dos conductores "vivos" (negro y rojo) y un conductor neutro (blanco/gris).</p>
                `
            },
            meter: {
                title: "Medidor Eléctrico",
                content: `
                    <p>Mide el consumo eléctrico en kilovatios-hora (kWh) para fines de facturación.</p>
                    <div class="spec">
                        Propietario: Compañía de Servicios<br>
                        Tipo: Digital o mecánico<br>
                        Base: Estándar NEMA/ANSI<br>
                        Sellado: Evidente de manipulación
                    </div>
                    <div class="warning">
                        <strong>⚠ Nunca tocar o modificar:</strong> El medidor y su base son propiedad de la compañía de servicios. La manipulación es ilegal y extremadamente peligrosa.
                    </div>
                    <p>El medidor monitorea la energía que fluye a través de él sin interrumpir el servicio. Toda la energía consumida en la casa pasa por este medidor.</p>
                `
            },
            panel: {
                title: "Panel de Servicio Principal (200A)",
                content: `
                    <p>El panel actual de tu cliente: Square D Q22200NRB</p>
                    <div class="spec">
                        Modelo: Square D Q22200NRB<br>
                        Interruptor Principal: 200 Amperios<br>
                        Voltaje: 120/240V AC<br>
                        Tipo: Bifásico residencial<br>
                        Gabinete: Tipo 3R (resistente a la lluvia)<br>
                        Espacios: 40 circuitos (típico)
                    </div>
                    <p><strong>Función del interruptor principal:</strong> Protege todo el sistema eléctrico de sobrecorriente. Si la carga total excede 200A, se dispara para prevenir sobrecalentamiento de cables e incendio.</p>
                    <p><strong>Interruptores de rama:</strong> Los interruptores individuales protegen cada circuito (iluminación, tomas, electrodomésticos). Están dimensionados según el calibre del cable y la carga esperada.</p>
                    <div class="note">
                        <strong>Punto clave:</strong> Aquí es donde agregarás el interruptor inteligente para la automatización de iluminación exterior. Se conecta a uno de los interruptores de circuito de rama.
                    </div>
                `
            },
            ground: {
                title: "Sistema de Puesta a Tierra",
                content: `
                    <p>Sistema de seguridad crítico que proporciona un camino para que la corriente de falla fluya de manera segura a tierra.</p>
                    <div class="spec">
                        Varilla de Tierra: 2.4m cobre o recubierto de cobre<br>
                        Cable: Calibre #4 AWG cobre (mínimo)<br>
                        Conexión: Soldadura exotérmica o abrazadera<br>
                        Profundidad: Mínimo 2.4 metros en tierra
                    </div>
                    <p><strong>Por qué es importante:</strong> Si un cable vivo toca un gabinete metálico, la tierra proporciona un camino de baja resistencia de vuelta al panel. Esto causa un alto flujo de corriente, disparando el interruptor inmediatamente.</p>
                    <p>Sin una puesta a tierra adecuada, ese gabinete metálico estaría energizado a 120V, esperando electrocutar a cualquiera que lo toque.</p>
                    <div class="warning">
                        <strong>Requisito NEC:</strong> Todos los gabinetes metálicos, tuberías y equipos deben estar conectados al sistema de puesta a tierra.
                    </div>
                `
            }
        };

        // Add click handlers
        const panel = document.getElementById('info-panel');
        const closeBtn = document.getElementById('close-btn');

        document.querySelectorAll('.component').forEach(component => {
            component.addEventListener('click', function() {
                const infoKey = this.getAttribute('data-info');
                if (infoKey && infoContent[infoKey]) {
                    const info = infoContent[infoKey];
                    panel.innerHTML = `<button class="close-btn visible" id="close-btn" title="Reiniciar">×</button><h3>${info.title}</h3>${info.content}`;

                    document.getElementById('close-btn').addEventListener('click', resetPanel);

                    document.querySelectorAll('.component').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });

        function resetPanel() {
            panel.innerHTML = defaultContent;
            document.querySelectorAll('.component').forEach(c => c.classList.remove('active'));
        }

        closeBtn.addEventListener('click', resetPanel);

        // Highlight wires on hover
        const wireGroups = {
            'service-drop': ['wire-hot1', 'wire-hot2', 'wire-neutral'],
            'meter-to-panel': ['wire-meter-hot1', 'wire-meter-hot2', 'wire-meter-neutral']
        };

        Object.entries(wireGroups).forEach(([groupId, wireIds]) => {
            const group = document.getElementById(groupId);
            if (group) {
                group.addEventListener('mouseenter', () => {
                    wireIds.forEach(id => {
                        const wire = document.getElementById(id);
                        if (wire) wire.classList.add('active');
                    });
                });
                group.addEventListener('mouseleave', () => {
                    wireIds.forEach(id => {
                        const wire = document.getElementById(id);
                        if (wire) wire.classList.remove('active');
                    });
                });
            }
        });
    </script>
</body>
</html>
